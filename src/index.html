<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script src="index.ts"></script>

<script>
const {
          Client,
          AuthorizationMiddleware,
          ResponseDataMiddleware,
          ETagMiddleware
      } = window.streams_api;
console.log('Client', Client);
const client = new Client({
    baseURL: 'http://streams-dev.local/api',
    middlewares: [
        new AuthorizationMiddleware({
            type: 'bearer',
            token:  'asdfsdf'
        }),
        new ETagMiddleware()
    ]
});

console.log('client', client);
let streams;
client.streams.get().then(response => {
    streams = response.data;
    console.log('client.streams.get()', response);
    console.log('client.streams.get() streams', streams);
    return Promise.all(response.data.data.map(stream => client.streams.find(stream.id)))
}).then(responses => {
    console.log('streams.data.data.map.find responses', responses);
    return Promise.all(responses.map(response => client.entries.get(response.data.stream.id)))
}).then(responses => {
    console.log('client.entries.find(stream.id, entry.id) responses', responses);
    return Promise.all(responses.map(response => {
        return Promise.all(response.data.data.map(entry => client.entries.find(response.data.stream.id,entry.id)))
    }))
}).then(responses => {
    console.log('final responses', responses)
})

</script>
</body>
</html>