"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var e,r=t(require("util")),n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function o(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(e){i(e)}}function a(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))}!function(t){!function(e){var r="object"==typeof n?n:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),o=i(t);function i(t,e){return function(r,n){"function"!=typeof t[r]&&Object.defineProperty(t,r,{configurable:!0,writable:!0,value:n}),e&&e(r,n)}}void 0===r.Reflect?r.Reflect=t:o=i(r.Reflect,o),function(t){var e=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",i="function"==typeof Object.create,s={__proto__:[]}instanceof Array,a=!i&&!s,c={create:i?function(){return nt(Object.create(null))}:s?function(){return nt({__proto__:null})}:function(){return nt({})},has:a?function(t,r){return e.call(t,r)}:function(t,e){return e in t},get:a?function(t,r){return e.call(t,r)?t[r]:void 0}:function(t,e){return t[e]}},u=Object.getPrototypeOf(Function),l="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,p=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?tt():Map,f=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?et():Set,h=new(l||"function"!=typeof WeakMap?rt():WeakMap);function y(t,e,r,n){if(M(r)){if(!B(t))throw new TypeError;if(!G(e))throw new TypeError;return S(t,e)}if(!B(t))throw new TypeError;if(!L(e))throw new TypeError;if(!L(n)&&!M(n)&&!D(n))throw new TypeError;return D(n)&&(n=void 0),A(t,e,r=H(r),n)}function d(t,e){function r(r,n){if(!L(r))throw new TypeError;if(!M(n)&&!V(n))throw new TypeError;$(t,e,r,n)}return r}function g(t,e,r,n){if(!L(r))throw new TypeError;return M(n)||(n=H(n)),$(t,e,r,n)}function m(t,e,r){if(!L(e))throw new TypeError;return M(r)||(r=H(r)),P(t,e,r)}function v(t,e,r){if(!L(e))throw new TypeError;return M(r)||(r=H(r)),x(t,e,r)}function b(t,e,r){if(!L(e))throw new TypeError;return M(r)||(r=H(r)),k(t,e,r)}function w(t,e,r){if(!L(e))throw new TypeError;return M(r)||(r=H(r)),R(t,e,r)}function _(t,e){if(!L(t))throw new TypeError;return M(e)||(e=H(e)),I(t,e)}function j(t,e){if(!L(t))throw new TypeError;return M(e)||(e=H(e)),T(t,e)}function O(t,e,r){if(!L(e))throw new TypeError;M(r)||(r=H(r));var n=E(e,r,!1);if(M(n))return!1;if(!n.delete(t))return!1;if(n.size>0)return!0;var o=h.get(e);return o.delete(r),o.size>0||h.delete(e),!0}function S(t,e){for(var r=t.length-1;r>=0;--r){var n=(0,t[r])(e);if(!M(n)&&!D(n)){if(!G(n))throw new TypeError;e=n}}return e}function A(t,e,r,n){for(var o=t.length-1;o>=0;--o){var i=(0,t[o])(e,r,n);if(!M(i)&&!D(i)){if(!L(i))throw new TypeError;n=i}}return n}function E(t,e,r){var n=h.get(t);if(M(n)){if(!r)return;n=new p,h.set(t,n)}var o=n.get(e);if(M(o)){if(!r)return;o=new p,n.set(e,o)}return o}function P(t,e,r){if(x(t,e,r))return!0;var n=Z(e);return!D(n)&&P(t,n,r)}function x(t,e,r){var n=E(e,r,!1);return!M(n)&&q(n.has(t))}function k(t,e,r){if(x(t,e,r))return R(t,e,r);var n=Z(e);return D(n)?void 0:k(t,n,r)}function R(t,e,r){var n=E(e,r,!1);if(!M(n))return n.get(t)}function $(t,e,r,n){E(r,n,!0).set(t,e)}function I(t,e){var r=T(t,e),n=Z(t);if(null===n)return r;var o=I(n,e);if(o.length<=0)return r;if(r.length<=0)return o;for(var i=new f,s=[],a=0,c=r;a<c.length;a++){i.has(p=c[a])||(i.add(p),s.push(p))}for(var u=0,l=o;u<l.length;u++){var p;i.has(p=l[u])||(i.add(p),s.push(p))}return s}function T(t,e){var r=[],n=E(t,e,!1);if(M(n))return r;for(var o=K(n.keys()),i=0;;){var s=X(o);if(!s)return r.length=i,r;var a=J(s);try{r[i]=a}catch(c){try{Y(o)}finally{throw c}}i++}}function C(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function M(t){return void 0===t}function D(t){return null===t}function F(t){return"symbol"==typeof t}function L(t){return"object"==typeof t?null!==t:"function"==typeof t}function N(t,e){switch(C(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var r=3===e?"string":5===e?"number":"default",o=Q(t,n);if(void 0!==o){var i=o.call(t,r);if(L(i))throw new TypeError;return i}return U(t,"default"===r?"number":r)}function U(t,e){if("string"===e){var r=t.toString;if(z(r))if(!L(o=r.call(t)))return o;if(z(n=t.valueOf))if(!L(o=n.call(t)))return o}else{var n;if(z(n=t.valueOf))if(!L(o=n.call(t)))return o;var o,i=t.toString;if(z(i))if(!L(o=i.call(t)))return o}throw new TypeError}function q(t){return!!t}function W(t){return""+t}function H(t){var e=N(t,3);return F(e)?e:W(e)}function B(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function z(t){return"function"==typeof t}function G(t){return"function"==typeof t}function V(t){switch(C(t)){case 3:case 4:return!0;default:return!1}}function Q(t,e){var r=t[e];if(null!=r){if(!z(r))throw new TypeError;return r}}function K(t){var e=Q(t,o);if(!z(e))throw new TypeError;var r=e.call(t);if(!L(r))throw new TypeError;return r}function J(t){return t.value}function X(t){var e=t.next();return!e.done&&e}function Y(t){var e=t.return;e&&e.call(t)}function Z(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===u)return e;if(e!==u)return e;var r=t.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return e;var o=n.constructor;return"function"!=typeof o||o===t?e:o}function tt(){var t={},e=[],r=function(){function t(t,e,r){this._index=0,this._keys=t,this._values=e,this._selector=r}return t.prototype["@@iterator"]=function(){return this},t.prototype[o]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var r=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var r=this._find(t,!0);return this._values[r]=e,this},e.prototype.delete=function(e){var r=this._find(e,!1);if(r>=0){for(var n=this._keys.length,o=r+1;o<n;o++)this._keys[o-1]=this._keys[o],this._values[o-1]=this._values[o];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new r(this._keys,this._values,n)},e.prototype.values=function(){return new r(this._keys,this._values,i)},e.prototype.entries=function(){return new r(this._keys,this._values,s)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[o]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function n(t,e){return t}function i(t,e){return e}function s(t,e){return[t,e]}}function et(){return function(){function t(){this._map=new p}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[o]=function(){return this.keys()},t}()}function rt(){var t=16,r=c.create(),n=o();return function(){function t(){this._key=o()}return t.prototype.has=function(t){var e=i(t,!1);return void 0!==e&&c.has(e,this._key)},t.prototype.get=function(t){var e=i(t,!1);return void 0!==e?c.get(e,this._key):void 0},t.prototype.set=function(t,e){return i(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=i(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=o()},t}();function o(){var t;do{t="@@WeakMap@@"+u()}while(c.has(r,t));return r[t]=!0,t}function i(t,r){if(!e.call(t,n)){if(!r)return;Object.defineProperty(t,n,{value:c.create()})}return t[n]}function s(t,e){for(var r=0;r<e;++r)t[r]=255*Math.random()|0;return t}function a(t){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):s(new Uint8Array(t),t):s(new Array(t),t)}function u(){var e=a(t);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var r="",n=0;n<t;++n){var o=e[n];4!==n&&6!==n&&8!==n||(r+="-"),o<16&&(r+="0"),r+=o.toString(16).toLowerCase()}return r}}function nt(t){return t.__=void 0,delete t.__,t}t("decorate",y),t("metadata",d),t("defineMetadata",g),t("hasMetadata",m),t("hasOwnMetadata",v),t("getMetadata",b),t("getOwnMetadata",w),t("getMetadataKeys",_),t("getOwnMetadataKeys",j),t("deleteMetadata",O)}(o)}()}(e||(e={}));var i=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===s}(t)}(t)};var s="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function a(t,e){return!1!==e.clone&&e.isMergeableObject(t)?f(Array.isArray(t)?[]:{},t,e):t}function c(t,e,r){return t.concat(e).map((function(t){return a(t,r)}))}function u(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(e){return t.propertyIsEnumerable(e)})):[]}(t))}function l(t,e){try{return e in t}catch(r){return!1}}function p(t,e,r){var n={};return r.isMergeableObject(t)&&u(t).forEach((function(e){n[e]=a(t[e],r)})),u(e).forEach((function(o){(function(t,e){return l(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,o)||(n[o]=l(t,o)&&r.isMergeableObject(e[o])?function(t,e){if(!e.customMerge)return f;var r=e.customMerge(t);return"function"==typeof r?r:f}(o,r)(t[o],e[o],r):a(e[o],r))})),n}function f(t,e,r){(r=r||{}).arrayMerge=r.arrayMerge||c,r.isMergeableObject=r.isMergeableObject||i,r.cloneUnlessOtherwiseSpecified=a;var n=Array.isArray(e);return n===Array.isArray(t)?n?r.arrayMerge(t,e,r):p(t,e,r):a(e,r)}f.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,r){return f(t,r,e)}),{})};var h=f;const y=r.default.deprecate((()=>{}),"Hook.context is deprecated and will be removed"),d=function(...t){return this.call=this._createCall("sync"),this.call(...t)},g=function(...t){return this.callAsync=this._createCall("async"),this.callAsync(...t)},m=function(...t){return this.promise=this._createCall("promise"),this.promise(...t)};class v{constructor(t=[],e){this._args=t,this.name=e,this.taps=[],this.interceptors=[],this._call=d,this.call=d,this._callAsync=g,this.callAsync=g,this._promise=m,this.promise=m,this._x=void 0,this.compile=this.compile,this.tap=this.tap,this.tapAsync=this.tapAsync,this.tapPromise=this.tapPromise}compile(t){throw new Error("Abstract: should be overridden")}_createCall(t){return this.compile({taps:this.taps,interceptors:this.interceptors,args:this._args,type:t})}_tap(t,e,r){if("string"==typeof e)e={name:e.trim()};else if("object"!=typeof e||null===e)throw new Error("Invalid tap options");if("string"!=typeof e.name||""===e.name)throw new Error("Missing name for tap");void 0!==e.context&&y(),e=Object.assign({type:t,fn:r},e),e=this._runRegisterInterceptors(e),this._insert(e)}tap(t,e){this._tap("sync",t,e)}tapAsync(t,e){this._tap("async",t,e)}tapPromise(t,e){this._tap("promise",t,e)}_runRegisterInterceptors(t){for(const e of this.interceptors)if(e.register){const r=e.register(t);void 0!==r&&(t=r)}return t}withOptions(t){const e=e=>Object.assign({},t,"string"==typeof e?{name:e}:e);return{name:this.name,tap:(t,r)=>this.tap(e(t),r),tapAsync:(t,r)=>this.tapAsync(e(t),r),tapPromise:(t,r)=>this.tapPromise(e(t),r),intercept:t=>this.intercept(t),isUsed:()=>this.isUsed(),withOptions:t=>this.withOptions(e(t))}}isUsed(){return this.taps.length>0||this.interceptors.length>0}intercept(t){if(this._resetCompilation(),this.interceptors.push(Object.assign({},t)),t.register)for(let e=0;e<this.taps.length;e++)this.taps[e]=t.register(this.taps[e])}_resetCompilation(){this.call=this._call,this.callAsync=this._callAsync,this.promise=this._promise}_insert(t){let e;this._resetCompilation(),"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));let r=0;"number"==typeof t.stage&&(r=t.stage);let n=this.taps.length;for(;n>0;){n--;const t=this.taps[n];this.taps[n+1]=t;const o=t.stage||0;if(e){if(e.has(t.name)){e.delete(t.name);continue}if(e.size>0)continue}if(!(o>r)){n++;break}}this.taps[n]=t}}Object.setPrototypeOf(v.prototype,null);var b=v;var w=class{constructor(t){this.config=t,this.options=void 0,this._args=void 0}create(t){let e;switch(this.init(t),this.options.type){case"sync":e=new Function(this.args(),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:t=>`throw ${t};\n`,onResult:t=>`return ${t};\n`,resultReturns:!0,onDone:()=>"",rethrowIfPossible:!0}));break;case"async":e=new Function(this.args({after:"_callback"}),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:t=>`_callback(${t});\n`,onResult:t=>`_callback(null, ${t});\n`,onDone:()=>"_callback();\n"}));break;case"promise":let t=!1;const r=this.contentWithInterceptors({onError:e=>(t=!0,`_error(${e});\n`),onResult:t=>`_resolve(${t});\n`,onDone:()=>"_resolve();\n"});let n="";n+='"use strict";\n',n+=this.header(),n+="return new Promise((function(_resolve, _reject) {\n",t&&(n+="var _sync = true;\n",n+="function _error(_err) {\n",n+="if(_sync)\n",n+="_resolve(Promise.resolve().then((function() { throw _err; })));\n",n+="else\n",n+="_reject(_err);\n",n+="};\n"),n+=r,t&&(n+="_sync = false;\n"),n+="}));\n",e=new Function(this.args(),n)}return this.deinit(),e}setup(t,e){t._x=e.taps.map((t=>t.fn))}init(t){this.options=t,this._args=t.args.slice()}deinit(){this.options=void 0,this._args=void 0}contentWithInterceptors(t){if(this.options.interceptors.length>0){const e=t.onError,r=t.onResult,n=t.onDone;let o="";for(let t=0;t<this.options.interceptors.length;t++){const e=this.options.interceptors[t];e.call&&(o+=`${this.getInterceptor(t)}.call(${this.args({before:e.context?"_context":void 0})});\n`)}return o+=this.content(Object.assign(t,{onError:e&&(t=>{let r="";for(let e=0;e<this.options.interceptors.length;e++){this.options.interceptors[e].error&&(r+=`${this.getInterceptor(e)}.error(${t});\n`)}return r+=e(t),r}),onResult:r&&(t=>{let e="";for(let r=0;r<this.options.interceptors.length;r++){this.options.interceptors[r].result&&(e+=`${this.getInterceptor(r)}.result(${t});\n`)}return e+=r(t),e}),onDone:n&&(()=>{let t="";for(let e=0;e<this.options.interceptors.length;e++){this.options.interceptors[e].done&&(t+=`${this.getInterceptor(e)}.done();\n`)}return t+=n(),t})})),o}return this.content(t)}header(){let t="";return this.needContext()?t+="var _context = {};\n":t+="var _context;\n",t+="var _x = this._x;\n",this.options.interceptors.length>0&&(t+="var _taps = this.taps;\n",t+="var _interceptors = this.interceptors;\n"),t}needContext(){for(const t of this.options.taps)if(t.context)return!0;return!1}callTap(t,{onError:e,onResult:r,onDone:n,rethrowIfPossible:o}){let i="",s=!1;for(let c=0;c<this.options.interceptors.length;c++){const e=this.options.interceptors[c];e.tap&&(s||(i+=`var _tap${t} = ${this.getTap(t)};\n`,s=!0),i+=`${this.getInterceptor(c)}.tap(${e.context?"_context, ":""}_tap${t});\n`)}i+=`var _fn${t} = ${this.getTapFn(t)};\n`;const a=this.options.taps[t];switch(a.type){case"sync":o||(i+=`var _hasError${t} = false;\n`,i+="try {\n"),i+=r?`var _result${t} = _fn${t}(${this.args({before:a.context?"_context":void 0})});\n`:`_fn${t}(${this.args({before:a.context?"_context":void 0})});\n`,o||(i+="} catch(_err) {\n",i+=`_hasError${t} = true;\n`,i+=e("_err"),i+="}\n",i+=`if(!_hasError${t}) {\n`),r&&(i+=r(`_result${t}`)),n&&(i+=n()),o||(i+="}\n");break;case"async":let s="";s+=r?`(function(_err${t}, _result${t}) {\n`:`(function(_err${t}) {\n`,s+=`if(_err${t}) {\n`,s+=e(`_err${t}`),s+="} else {\n",r&&(s+=r(`_result${t}`)),n&&(s+=n()),s+="}\n",s+="})",i+=`_fn${t}(${this.args({before:a.context?"_context":void 0,after:s})});\n`;break;case"promise":i+=`var _hasResult${t} = false;\n`,i+=`var _promise${t} = _fn${t}(${this.args({before:a.context?"_context":void 0})});\n`,i+=`if (!_promise${t} || !_promise${t}.then)\n`,i+=`  throw new Error('Tap function (tapPromise) did not return promise (returned ' + _promise${t} + ')');\n`,i+=`_promise${t}.then((function(_result${t}) {\n`,i+=`_hasResult${t} = true;\n`,r&&(i+=r(`_result${t}`)),n&&(i+=n()),i+=`}), function(_err${t}) {\n`,i+=`if(_hasResult${t}) throw _err${t};\n`,i+=e(`_err${t}`),i+="});\n"}return i}callTapsSeries({onError:t,onResult:e,resultReturns:r,onDone:n,doneReturns:o,rethrowIfPossible:i}){if(0===this.options.taps.length)return n();const s=this.options.taps.findIndex((t=>"sync"!==t.type)),a=r||o;let c="",u=n,l=0;for(let p=this.options.taps.length-1;p>=0;p--){const r=p;u!==n&&("sync"!==this.options.taps[r].type||l++>20)&&(l=0,c+=`function _next${r}() {\n`,c+=u(),c+="}\n",u=()=>`${a?"return ":""}_next${r}();\n`);const o=u,f=t=>t?"":n(),h=this.callTap(r,{onError:e=>t(r,e,o,f),onResult:e&&(t=>e(r,t,o,f)),onDone:!e&&o,rethrowIfPossible:i&&(s<0||r<s)});u=()=>h}return c+=u(),c}callTapsLooping({onError:t,onDone:e,rethrowIfPossible:r}){if(0===this.options.taps.length)return e();const n=this.options.taps.every((t=>"sync"===t.type));let o="";n||(o+="var _looper = (function() {\n",o+="var _loopAsync = false;\n"),o+="var _loop;\n",o+="do {\n",o+="_loop = false;\n";for(let i=0;i<this.options.interceptors.length;i++){const t=this.options.interceptors[i];t.loop&&(o+=`${this.getInterceptor(i)}.loop(${this.args({before:t.context?"_context":void 0})});\n`)}return o+=this.callTapsSeries({onError:t,onResult:(t,e,r,o)=>{let i="";return i+=`if(${e} !== undefined) {\n`,i+="_loop = true;\n",n||(i+="if(_loopAsync) _looper();\n"),i+=o(!0),i+="} else {\n",i+=r(),i+="}\n",i},onDone:e&&(()=>{let t="";return t+="if(!_loop) {\n",t+=e(),t+="}\n",t}),rethrowIfPossible:r&&n}),o+="} while(_loop);\n",n||(o+="_loopAsync = true;\n",o+="});\n",o+="_looper();\n"),o}callTapsParallel({onError:t,onResult:e,onDone:r,rethrowIfPossible:n,onTap:o=((t,e)=>e())}){if(this.options.taps.length<=1)return this.callTapsSeries({onError:t,onResult:e,onDone:r,rethrowIfPossible:n});let i="";i+="do {\n",i+=`var _counter = ${this.options.taps.length};\n`,r&&(i+="var _done = (function() {\n",i+=r(),i+="});\n");for(let s=0;s<this.options.taps.length;s++){const a=()=>r?"if(--_counter === 0) _done();\n":"--_counter;",c=t=>t||!r?"_counter = 0;\n":"_counter = 0;\n_done();\n";i+="if(_counter <= 0) break;\n",i+=o(s,(()=>this.callTap(s,{onError:e=>{let r="";return r+="if(_counter > 0) {\n",r+=t(s,e,a,c),r+="}\n",r},onResult:e&&(t=>{let r="";return r+="if(_counter > 0) {\n",r+=e(s,t,a,c),r+="}\n",r}),onDone:!e&&(()=>a()),rethrowIfPossible:n})),a,c)}return i+="} while(false);\n",i}args({before:t,after:e}={}){let r=this._args;return t&&(r=[t].concat(r)),e&&(r=r.concat(e)),0===r.length?"":r.join(", ")}getTapFn(t){return`_x[${t}]`}getTap(t){return`_taps[${t}]`}getInterceptor(t){return`_interceptors[${t}]`}};const _=b,j=w;const O=new class extends j{content({onError:t,onDone:e,rethrowIfPossible:r}){return this.callTapsSeries({onError:(e,r)=>t(r),onDone:e,rethrowIfPossible:r})}},S=()=>{throw new Error("tapAsync is not supported on a SyncHook")},A=()=>{throw new Error("tapPromise is not supported on a SyncHook")},E=function(t){return O.setup(this,t),O.create(t)};function P(t=[],e){const r=new _(t,e);return r.constructor=P,r.tapAsync=S,r.tapPromise=A,r.compile=E,r}P.prototype=null;var x=P;const k=w;new class extends k{content({onError:t,onResult:e,resultReturns:r,onDone:n,rethrowIfPossible:o}){return this.callTapsSeries({onError:(e,r)=>t(r),onResult:(t,r,n)=>`if(${r} !== undefined) {\n${e(r)};\n} else {\n${n()}}\n`,resultReturns:r,onDone:n,rethrowIfPossible:o})}};const R=b,$=w;const I=new class extends ${content({onError:t,onResult:e,resultReturns:r,rethrowIfPossible:n}){return this.callTapsSeries({onError:(e,r)=>t(r),onResult:(t,e,r)=>{let n="";return n+=`if(${e} !== undefined) {\n`,n+=`${this._args[0]} = ${e};\n`,n+="}\n",n+=r(),n},onDone:()=>e(this._args[0]),doneReturns:r,rethrowIfPossible:n})}},T=()=>{throw new Error("tapAsync is not supported on a SyncWaterfallHook")},C=()=>{throw new Error("tapPromise is not supported on a SyncWaterfallHook")},M=function(t){return I.setup(this,t),I.create(t)};function D(t=[],e){if(t.length<1)throw new Error("Waterfall hooks must have at least one argument");const r=new R(t,e);return r.constructor=D,r.tapAsync=T,r.tapPromise=C,r.compile=M,r}D.prototype=null;var F=D;const L=w;new class extends L{content({onError:t,onDone:e,rethrowIfPossible:r}){return this.callTapsLooping({onError:(e,r)=>t(r),onDone:e,rethrowIfPossible:r})}};const N=w;new class extends N{content({onError:t,onDone:e}){return this.callTapsParallel({onError:(e,r,n,o)=>t(r)+o(!0),onDone:e})}};const U=w;new class extends U{content({onError:t,onResult:e,onDone:r}){let n="";return n+=`var _results = new Array(${this.options.taps.length});\n`,n+="var _checkDone = function() {\n",n+="for(var i = 0; i < _results.length; i++) {\n",n+="var item = _results[i];\n",n+="if(item === undefined) return false;\n",n+="if(item.result !== undefined) {\n",n+=e("item.result"),n+="return true;\n",n+="}\n",n+="if(item.error) {\n",n+=t("item.error"),n+="return true;\n",n+="}\n",n+="}\n",n+="return false;\n",n+="}\n",n+=this.callTapsParallel({onError:(t,e,r,n)=>{let o="";return o+=`if(${t} < _results.length && ((_results.length = ${t+1}), (_results[${t}] = { error: ${e} }), _checkDone())) {\n`,o+=n(!0),o+="} else {\n",o+=r(),o+="}\n",o},onResult:(t,e,r,n)=>{let o="";return o+=`if(${t} < _results.length && (${e} !== undefined && (_results.length = ${t+1}), (_results[${t}] = { result: ${e} }), _checkDone())) {\n`,o+=n(!0),o+="} else {\n",o+=r(),o+="}\n",o},onTap:(t,e,r,n)=>{let o="";return t>0&&(o+=`if(${t} >= _results.length) {\n`,o+=r(),o+="} else {\n"),o+=e(),t>0&&(o+="}\n"),o},onDone:r}),n}};const q=w;new class extends q{content({onError:t,onDone:e}){return this.callTapsSeries({onError:(e,r,n,o)=>t(r)+o(!0),onDone:e})}};const W=w;new class extends W{content({onError:t,onResult:e,resultReturns:r,onDone:n}){return this.callTapsSeries({onError:(e,r,n,o)=>t(r)+o(!0),onResult:(t,r,n)=>`if(${r} !== undefined) {\n${e(r)}\n} else {\n${n()}}\n`,resultReturns:r,onDone:n})}};const H=w;new class extends H{content({onError:t,onDone:e}){return this.callTapsLooping({onError:(e,r,n,o)=>t(r)+o(!0),onDone:e})}};const B=b,z=w;const G=new class extends z{content({onError:t,onResult:e}){return this.callTapsSeries({onError:(e,r,n,o)=>t(r)+o(!0),onResult:(t,e,r)=>{let n="";return n+=`if(${e} !== undefined) {\n`,n+=`${this._args[0]} = ${e};\n`,n+="}\n",n+=r(),n},onDone:()=>e(this._args[0])})}},V=function(t){return G.setup(this,t),G.create(t)};function Q(t=[],e){if(t.length<1)throw new Error("Waterfall hooks must have at least one argument");const r=new B(t,e);return r.constructor=Q,r.compile=V,r._call=void 0,r.call=void 0,r}Q.prototype=null;var K=Q;const J=r.default,X=(t,e)=>e;class Y{constructor(t,e){this._map=new Map,this.name=e,this._factory=t,this._interceptors=[]}get(t){return this._map.get(t)}for(t){const e=this.get(t);if(void 0!==e)return e;let r=this._factory(t);const n=this._interceptors;for(let o=0;o<n.length;o++)r=n[o].factory(t,r);return this._map.set(t,r),r}intercept(t){this._interceptors.push(Object.assign({factory:X},t))}}Y.prototype.tap=J.deprecate((function(t,e,r){return this.for(t).tap(e,r)}),"HookMap#tap(key,…) is deprecated. Use HookMap#for(key).tap(…) instead."),Y.prototype.tapAsync=J.deprecate((function(t,e,r){return this.for(t).tapAsync(e,r)}),"HookMap#tapAsync(key,…) is deprecated. Use HookMap#for(key).tapAsync(…) instead."),Y.prototype.tapPromise=J.deprecate((function(t,e,r){return this.for(t).tapPromise(e,r)}),"HookMap#tapPromise(key,…) is deprecated. Use HookMap#for(key).tapPromise(…) instead.");var Z=x,tt=F,et=K;class rt extends Error{constructor(t,e){super(`HTTP ${t.status} Error: ${t.statusText}`),this.response=t,this.request=e,this.name="HTTPError"}}class nt{static random(t=15){let e="";const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<t;n++)e+=r.charAt(Math.floor(Math.random()*r.length));return e}static ensureLeft(t,e){return!1===t.startsWith(e)?e+t:t}static ensureRight(t,e){return!1===t.endsWith(e)?t+e:t}static stripLeft(t,e){return t.startsWith(e)?t.substr(e.length):t}static stripRight(t,e){return t.endsWith(e)?t.substr(0,t.length-e.length):t}static ucfirst(t){return t[0].toUpperCase()+t.slice(1)}static lcfirst(t){return t[0].toLowerCase()+t.slice(1)}static parameters(t,e){return Object.entries(e).forEach((([e,r])=>t=t.replace(new RegExp(":"+e,"g"),r))),t}}const ot=(t,[e,r])=>Object.assign(Object.assign({},t),{[e]:r});var it={exports:{}};const st=(t,e)=>{if("string"!=typeof t&&!Array.isArray(t))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},0===(t=Array.isArray(t)?t.map((t=>t.trim())).filter((t=>t.length)).join("-"):t.trim()).length)return"";if(1===t.length)return e.pascalCase?t.toLocaleUpperCase(e.locale):t.toLocaleLowerCase(e.locale);return t!==t.toLocaleLowerCase(e.locale)&&(t=((t,e)=>{let r=!1,n=!1,o=!1;for(let i=0;i<t.length;i++){const s=t[i];r&&/[\p{Lu}]/u.test(s)?(t=t.slice(0,i)+"-"+t.slice(i),r=!1,o=n,n=!0,i++):n&&o&&/[\p{Ll}]/u.test(s)?(t=t.slice(0,i-1)+"-"+t.slice(i-1),o=n,n=!1,r=!0):(r=s.toLocaleLowerCase(e)===s&&s.toLocaleUpperCase(e)!==s,o=n,n=s.toLocaleUpperCase(e)===s&&s.toLocaleLowerCase(e)!==s)}return t})(t,e.locale)),t=t.replace(/^[_.\- ]+/,""),t=e.preserveConsecutiveUppercase?(t=>t.replace(/^[\p{Lu}](?![\p{Lu}])/gu,(t=>t.toLowerCase())))(t):t.toLocaleLowerCase(),e.pascalCase&&(t=t.charAt(0).toLocaleUpperCase(e.locale)+t.slice(1)),((t,e)=>t.replace(/[_.\- ]+([\p{Alpha}\p{N}_]|$)/gu,((t,r)=>r.toLocaleUpperCase(e.locale))).replace(/\d+([\p{Alpha}\p{N}_]|$)/gu,(t=>t.toLocaleUpperCase(e.locale))))(t,e)};it.exports=st,it.exports.default=st;var at=it.exports,ct="undefined"!=typeof Symbol&&Symbol,ut=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),r=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var n=Object.getOwnPropertySymbols(t);if(1!==n.length||n[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(t,e);if(42!==o.value||!0!==o.enumerable)return!1}return!0},lt="Function.prototype.bind called on incompatible ",pt=Array.prototype.slice,ft=Object.prototype.toString,ht=function(t){var e=this;if("function"!=typeof e||"[object Function]"!==ft.call(e))throw new TypeError(lt+e);for(var r,n=pt.call(arguments,1),o=function(){if(this instanceof r){var o=e.apply(this,n.concat(pt.call(arguments)));return Object(o)===o?o:this}return e.apply(t,n.concat(pt.call(arguments)))},i=Math.max(0,e.length-n.length),s=[],a=0;a<i;a++)s.push("$"+a);if(r=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(o),e.prototype){var c=function(){};c.prototype=e.prototype,r.prototype=new c,c.prototype=null}return r},yt=Function.prototype.bind||ht,dt=yt.call(Function.call,Object.prototype.hasOwnProperty),gt=SyntaxError,mt=Function,vt=TypeError,bt=function(t){try{return mt('"use strict"; return ('+t+").constructor;")()}catch(e){}},wt=Object.getOwnPropertyDescriptor;if(wt)try{wt({},"")}catch(Dr){wt=null}var _t=function(){throw new vt},jt=wt?function(){try{return _t}catch(t){try{return wt(arguments,"callee").get}catch(e){return _t}}}():_t,Ot="function"==typeof ct&&"function"==typeof Symbol&&"symbol"==typeof ct("foo")&&"symbol"==typeof Symbol("bar")&&ut(),St=Object.getPrototypeOf||function(t){return t.__proto__},At={},Et="undefined"==typeof Uint8Array?undefined:St(Uint8Array),Pt={"%AggregateError%":"undefined"==typeof AggregateError?undefined:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?undefined:ArrayBuffer,"%ArrayIteratorPrototype%":Ot?St([][Symbol.iterator]()):undefined,"%AsyncFromSyncIteratorPrototype%":undefined,"%AsyncFunction%":At,"%AsyncGenerator%":At,"%AsyncGeneratorFunction%":At,"%AsyncIteratorPrototype%":At,"%Atomics%":"undefined"==typeof Atomics?undefined:Atomics,"%BigInt%":"undefined"==typeof BigInt?undefined:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?undefined:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?undefined:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?undefined:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?undefined:FinalizationRegistry,"%Function%":mt,"%GeneratorFunction%":At,"%Int8Array%":"undefined"==typeof Int8Array?undefined:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?undefined:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?undefined:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Ot?St(St([][Symbol.iterator]())):undefined,"%JSON%":"object"==typeof JSON?JSON:undefined,"%Map%":"undefined"==typeof Map?undefined:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&Ot?St((new Map)[Symbol.iterator]()):undefined,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?undefined:Promise,"%Proxy%":"undefined"==typeof Proxy?undefined:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?undefined:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?undefined:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&Ot?St((new Set)[Symbol.iterator]()):undefined,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?undefined:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Ot?St(""[Symbol.iterator]()):undefined,"%Symbol%":Ot?Symbol:undefined,"%SyntaxError%":gt,"%ThrowTypeError%":jt,"%TypedArray%":Et,"%TypeError%":vt,"%Uint8Array%":"undefined"==typeof Uint8Array?undefined:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?undefined:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?undefined:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?undefined:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?undefined:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?undefined:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?undefined:WeakSet},xt=function t(e){var r;if("%AsyncFunction%"===e)r=bt("async function () {}");else if("%GeneratorFunction%"===e)r=bt("function* () {}");else if("%AsyncGeneratorFunction%"===e)r=bt("async function* () {}");else if("%AsyncGenerator%"===e){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===e){var o=t("%AsyncGenerator%");o&&(r=St(o.prototype))}return Pt[e]=r,r},kt={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Rt=yt,$t=dt,It=Rt.call(Function.call,Array.prototype.concat),Tt=Rt.call(Function.apply,Array.prototype.splice),Ct=Rt.call(Function.call,String.prototype.replace),Mt=Rt.call(Function.call,String.prototype.slice),Dt=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Ft=/\\(\\)?/g,Lt=function(t){var e=Mt(t,0,1),r=Mt(t,-1);if("%"===e&&"%"!==r)throw new gt("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==e)throw new gt("invalid intrinsic syntax, expected opening `%`");var n=[];return Ct(t,Dt,(function(t,e,r,o){n[n.length]=r?Ct(o,Ft,"$1"):e||t})),n},Nt=function(t,e){var r,n=t;if($t(kt,n)&&(n="%"+(r=kt[n])[0]+"%"),$t(Pt,n)){var o=Pt[n];if(o===At&&(o=xt(n)),void 0===o&&!e)throw new vt("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:o}}throw new gt("intrinsic "+t+" does not exist!")},Ut=function(t,e){if("string"!=typeof t||0===t.length)throw new vt("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new vt('"allowMissing" argument must be a boolean');var r=Lt(t),n=r.length>0?r[0]:"",o=Nt("%"+n+"%",e),i=o.name,s=o.value,a=!1,c=o.alias;c&&(n=c[0],Tt(r,It([0,1],c)));for(var u=1,l=!0;u<r.length;u+=1){var p=r[u],f=Mt(p,0,1),h=Mt(p,-1);if(('"'===f||"'"===f||"`"===f||'"'===h||"'"===h||"`"===h)&&f!==h)throw new gt("property names with quotes must have matching quotes");if("constructor"!==p&&l||(a=!0),$t(Pt,i="%"+(n+="."+p)+"%"))s=Pt[i];else if(null!=s){if(!(p in s)){if(!e)throw new vt("base intrinsic for "+t+" exists, but the property is not available.");return}if(wt&&u+1>=r.length){var y=wt(s,p);s=(l=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:s[p]}else l=$t(s,p),s=s[p];l&&!a&&(Pt[i]=s)}}return s},qt={exports:{}};!function(t){var e=yt,r=Ut,n=r("%Function.prototype.apply%"),o=r("%Function.prototype.call%"),i=r("%Reflect.apply%",!0)||e.call(o,n),s=r("%Object.getOwnPropertyDescriptor%",!0),a=r("%Object.defineProperty%",!0),c=r("%Math.max%");if(a)try{a({},"a",{value:1})}catch(Dr){a=null}t.exports=function(t){var r=i(e,o,arguments);if(s&&a){var n=s(r,"length");n.configurable&&a(r,"length",{value:1+c(0,t.length-(arguments.length-1))})}return r};var u=function(){return i(e,n,arguments)};a?a(t.exports,"apply",{value:u}):t.exports.apply=u}(qt);var Wt=Ut,Ht=qt.exports,Bt=Ht(Wt("String.prototype.indexOf")),zt=r.default.inspect,Gt="function"==typeof Map&&Map.prototype,Vt=Object.getOwnPropertyDescriptor&&Gt?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Qt=Gt&&Vt&&"function"==typeof Vt.get?Vt.get:null,Kt=Gt&&Map.prototype.forEach,Jt="function"==typeof Set&&Set.prototype,Xt=Object.getOwnPropertyDescriptor&&Jt?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Yt=Jt&&Xt&&"function"==typeof Xt.get?Xt.get:null,Zt=Jt&&Set.prototype.forEach,te="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,ee="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,re="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,ne=Boolean.prototype.valueOf,oe=Object.prototype.toString,ie=Function.prototype.toString,se=String.prototype.match,ae="function"==typeof BigInt?BigInt.prototype.valueOf:null,ce=Object.getOwnPropertySymbols,ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,le="function"==typeof Symbol&&"object"==typeof Symbol.iterator,pe=Object.prototype.propertyIsEnumerable,fe=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null),he=zt.custom,ye=he&&be(he)?he:null,de="function"==typeof Symbol&&void 0!==Symbol.toStringTag?Symbol.toStringTag:null;function ge(t,e,r){var n="double"===(r.quoteStyle||e)?'"':"'";return n+t+n}function me(t){return String(t).replace(/"/g,"&quot;")}function ve(t){return!("[object Array]"!==je(t)||de&&"object"==typeof t&&de in t)}function be(t){if(le)return t&&"object"==typeof t&&t instanceof Symbol;if("symbol"==typeof t)return!0;if(!t||"object"!=typeof t||!ue)return!1;try{return ue.call(t),!0}catch(Dr){}return!1}var we=Object.prototype.hasOwnProperty||function(t){return t in this};function _e(t,e){return we.call(t,e)}function je(t){return oe.call(t)}function Oe(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function Se(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return Se(t.slice(0,e.maxStringLength),e)+n}return ge(t.replace(/(['\\])/g,"\\$1").replace(/[\x00-\x1f]/g,Ae),"single",e)}function Ae(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+e.toString(16).toUpperCase()}function Ee(t){return"Object("+t+")"}function Pe(t){return t+" { ? }"}function xe(t,e,r,n){return t+" ("+e+") {"+(n?ke(r,n):r.join(", "))+"}"}function ke(t,e){if(0===t.length)return"";var r="\n"+e.prev+e.base;return r+t.join(","+r)+"\n"+e.prev}function Re(t,e){var r=ve(t),n=[];if(r){n.length=t.length;for(var o=0;o<t.length;o++)n[o]=_e(t,o)?e(t[o],t):""}var i,s="function"==typeof ce?ce(t):[];if(le){i={};for(var a=0;a<s.length;a++)i["$"+s[a]]=s[a]}for(var c in t)_e(t,c)&&(r&&String(Number(c))===c&&c<t.length||le&&i["$"+c]instanceof Symbol||(/[^\w$]/.test(c)?n.push(e(c,t)+": "+e(t[c],t)):n.push(c+": "+e(t[c],t))));if("function"==typeof ce)for(var u=0;u<s.length;u++)pe.call(t,s[u])&&n.push("["+e(s[u])+"]: "+e(t[s[u]],t));return n}var $e=Ut,Ie=function(t,e){var r=Wt(t,!!e);return"function"==typeof r&&Bt(t,".prototype.")>-1?Ht(r):r},Te=function t(e,r,n,o){var i=r||{};if(_e(i,"quoteStyle")&&"single"!==i.quoteStyle&&"double"!==i.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(_e(i,"maxStringLength")&&("number"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var s=!_e(i,"customInspect")||i.customInspect;if("boolean"!=typeof s&&"symbol"!==s)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(_e(i,"indent")&&null!==i.indent&&"\t"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('options "indent" must be "\\t", an integer > 0, or `null`');if(void 0===e)return"undefined";if(null===e)return"null";if("boolean"==typeof e)return e?"true":"false";if("string"==typeof e)return Se(e,i);if("number"==typeof e)return 0===e?1/0/e>0?"0":"-0":String(e);if("bigint"==typeof e)return String(e)+"n";var a=void 0===i.depth?5:i.depth;if(void 0===n&&(n=0),n>=a&&a>0&&"object"==typeof e)return ve(e)?"[Array]":"[Object]";var c=function(t,e){var r;if("\t"===t.indent)r="\t";else{if(!("number"==typeof t.indent&&t.indent>0))return null;r=Array(t.indent+1).join(" ")}return{base:r,prev:Array(e+1).join(r)}}(i,n);if(void 0===o)o=[];else if(Oe(o,e)>=0)return"[Circular]";function u(e,r,s){if(r&&(o=o.slice()).push(r),s){var a={depth:i.depth};return _e(i,"quoteStyle")&&(a.quoteStyle=i.quoteStyle),t(e,a,n+1,o)}return t(e,i,n+1,o)}if("function"==typeof e){var l=function(t){if(t.name)return t.name;var e=se.call(ie.call(t),/^function\s*([\w$]+)/);if(e)return e[1];return null}(e),p=Re(e,u);return"[Function"+(l?": "+l:" (anonymous)")+"]"+(p.length>0?" { "+p.join(", ")+" }":"")}if(be(e)){var f=le?String(e).replace(/^(Symbol\(.*\))_[^)]*$/,"$1"):ue.call(e);return"object"!=typeof e||le?f:Ee(f)}if(function(t){if(!t||"object"!=typeof t)return!1;if("undefined"!=typeof HTMLElement&&t instanceof HTMLElement)return!0;return"string"==typeof t.nodeName&&"function"==typeof t.getAttribute}(e)){for(var h="<"+String(e.nodeName).toLowerCase(),y=e.attributes||[],d=0;d<y.length;d++)h+=" "+y[d].name+"="+ge(me(y[d].value),"double",i);return h+=">",e.childNodes&&e.childNodes.length&&(h+="..."),h+="</"+String(e.nodeName).toLowerCase()+">"}if(ve(e)){if(0===e.length)return"[]";var g=Re(e,u);return c&&!function(t){for(var e=0;e<t.length;e++)if(Oe(t[e],"\n")>=0)return!1;return!0}(g)?"["+ke(g,c)+"]":"[ "+g.join(", ")+" ]"}if(function(t){return!("[object Error]"!==je(t)||de&&"object"==typeof t&&de in t)}(e)){var m=Re(e,u);return 0===m.length?"["+String(e)+"]":"{ ["+String(e)+"] "+m.join(", ")+" }"}if("object"==typeof e&&s){if(ye&&"function"==typeof e[ye])return e[ye]();if("symbol"!==s&&"function"==typeof e.inspect)return e.inspect()}if(function(t){if(!Qt||!t||"object"!=typeof t)return!1;try{Qt.call(t);try{Yt.call(t)}catch(h){return!0}return t instanceof Map}catch(Dr){}return!1}(e)){var v=[];return Kt.call(e,(function(t,r){v.push(u(r,e,!0)+" => "+u(t,e))})),xe("Map",Qt.call(e),v,c)}if(function(t){if(!Yt||!t||"object"!=typeof t)return!1;try{Yt.call(t);try{Qt.call(t)}catch(e){return!0}return t instanceof Set}catch(Dr){}return!1}(e)){var b=[];return Zt.call(e,(function(t){b.push(u(t,e))})),xe("Set",Yt.call(e),b,c)}if(function(t){if(!te||!t||"object"!=typeof t)return!1;try{te.call(t,te);try{ee.call(t,ee)}catch(h){return!0}return t instanceof WeakMap}catch(Dr){}return!1}(e))return Pe("WeakMap");if(function(t){if(!ee||!t||"object"!=typeof t)return!1;try{ee.call(t,ee);try{te.call(t,te)}catch(h){return!0}return t instanceof WeakSet}catch(Dr){}return!1}(e))return Pe("WeakSet");if(function(t){if(!re||!t||"object"!=typeof t)return!1;try{return re.call(t),!0}catch(Dr){}return!1}(e))return Pe("WeakRef");if(function(t){return!("[object Number]"!==je(t)||de&&"object"==typeof t&&de in t)}(e))return Ee(u(Number(e)));if(function(t){if(!t||"object"!=typeof t||!ae)return!1;try{return ae.call(t),!0}catch(Dr){}return!1}(e))return Ee(u(ae.call(e)));if(function(t){return!("[object Boolean]"!==je(t)||de&&"object"==typeof t&&de in t)}(e))return Ee(ne.call(e));if(function(t){return!("[object String]"!==je(t)||de&&"object"==typeof t&&de in t)}(e))return Ee(u(String(e)));if(!function(t){return!("[object Date]"!==je(t)||de&&"object"==typeof t&&de in t)}(e)&&!function(t){return!("[object RegExp]"!==je(t)||de&&"object"==typeof t&&de in t)}(e)){var w=Re(e,u),_=fe?fe(e)===Object.prototype:e instanceof Object||e.constructor===Object,j=e instanceof Object?"":"null prototype",O=!_&&de&&Object(e)===e&&de in e?je(e).slice(8,-1):j?"Object":"",S=(_||"function"!=typeof e.constructor?"":e.constructor.name?e.constructor.name+" ":"")+(O||j?"["+[].concat(O||[],j||[]).join(": ")+"] ":"");return 0===w.length?S+"{}":c?S+"{"+ke(w,c)+"}":S+"{ "+w.join(", ")+" }"}return String(e)},Ce=$e("%TypeError%"),Me=$e("%WeakMap%",!0),De=$e("%Map%",!0),Fe=Ie("WeakMap.prototype.get",!0),Le=Ie("WeakMap.prototype.set",!0),Ne=Ie("WeakMap.prototype.has",!0),Ue=Ie("Map.prototype.get",!0),qe=Ie("Map.prototype.set",!0),We=Ie("Map.prototype.has",!0),He=function(t,e){for(var r,n=t;null!==(r=n.next);n=r)if(r.key===e)return n.next=r.next,r.next=t.next,t.next=r,r},Be=String.prototype.replace,ze=/%20/g,Ge="RFC3986",Ve={default:Ge,formatters:{RFC1738:function(t){return Be.call(t,ze,"+")},RFC3986:function(t){return String(t)}},RFC1738:"RFC1738",RFC3986:Ge},Qe=Ve,Ke=Object.prototype.hasOwnProperty,Je=Array.isArray,Xe=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),Ye=function(t,e){for(var r=e&&e.plainObjects?Object.create(null):{},n=0;n<t.length;++n)void 0!==t[n]&&(r[n]=t[n]);return r},Ze={arrayToObject:Ye,assign:function(t,e){return Object.keys(e).reduce((function(t,r){return t[r]=e[r],t}),t)},combine:function(t,e){return[].concat(t,e)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],r=[],n=0;n<e.length;++n)for(var o=e[n],i=o.obj[o.prop],s=Object.keys(i),a=0;a<s.length;++a){var c=s[a],u=i[c];"object"==typeof u&&null!==u&&-1===r.indexOf(u)&&(e.push({obj:i,prop:c}),r.push(u))}return function(t){for(;t.length>1;){var e=t.pop(),r=e.obj[e.prop];if(Je(r)){for(var n=[],o=0;o<r.length;++o)void 0!==r[o]&&n.push(r[o]);e.obj[e.prop]=n}}}(e),t},decode:function(t,e,r){var n=t.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(Dr){return n}},encode:function(t,e,r,n,o){if(0===t.length)return t;var i=t;if("symbol"==typeof t?i=Symbol.prototype.toString.call(t):"string"!=typeof t&&(i=String(t)),"iso-8859-1"===r)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"}));for(var s="",a=0;a<i.length;++a){var c=i.charCodeAt(a);45===c||46===c||95===c||126===c||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||o===Qe.RFC1738&&(40===c||41===c)?s+=i.charAt(a):c<128?s+=Xe[c]:c<2048?s+=Xe[192|c>>6]+Xe[128|63&c]:c<55296||c>=57344?s+=Xe[224|c>>12]+Xe[128|c>>6&63]+Xe[128|63&c]:(c=65536+((1023&c)<<10|1023&i.charCodeAt(a+=1)),s+=Xe[240|c>>18]+Xe[128|c>>12&63]+Xe[128|c>>6&63]+Xe[128|63&c])}return s},isBuffer:function(t){return!(!t||"object"!=typeof t)&&!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},maybeMap:function(t,e){if(Je(t)){for(var r=[],n=0;n<t.length;n+=1)r.push(e(t[n]));return r}return e(t)},merge:function t(e,r,n){if(!r)return e;if("object"!=typeof r){if(Je(e))e.push(r);else{if(!e||"object"!=typeof e)return[e,r];(n&&(n.plainObjects||n.allowPrototypes)||!Ke.call(Object.prototype,r))&&(e[r]=!0)}return e}if(!e||"object"!=typeof e)return[e].concat(r);var o=e;return Je(e)&&!Je(r)&&(o=Ye(e,n)),Je(e)&&Je(r)?(r.forEach((function(r,o){if(Ke.call(e,o)){var i=e[o];i&&"object"==typeof i&&r&&"object"==typeof r?e[o]=t(i,r,n):e.push(r)}else e[o]=r})),e):Object.keys(r).reduce((function(e,o){var i=r[o];return e[o]=Ke.call(e,o)?t(e[o],i,n):i,e}),o)}},tr=function(){var t,e,r,n={assert:function(t){if(!n.has(t))throw new Ce("Side channel does not contain "+Te(t))},get:function(n){if(Me&&n&&("object"==typeof n||"function"==typeof n)){if(t)return Fe(t,n)}else if(De){if(e)return Ue(e,n)}else if(r)return function(t,e){var r=He(t,e);return r&&r.value}(r,n)},has:function(n){if(Me&&n&&("object"==typeof n||"function"==typeof n)){if(t)return Ne(t,n)}else if(De){if(e)return We(e,n)}else if(r)return function(t,e){return!!He(t,e)}(r,n);return!1},set:function(n,o){Me&&n&&("object"==typeof n||"function"==typeof n)?(t||(t=new Me),Le(t,n,o)):De?(e||(e=new De),qe(e,n,o)):(r||(r={key:{},next:null}),function(t,e,r){var n=He(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}}(r,n,o))}};return n},er=Ze,rr=Ve,nr=Object.prototype.hasOwnProperty,or={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},ir=Array.isArray,sr=Array.prototype.push,ar=function(t,e){sr.apply(t,ir(e)?e:[e])},cr=Date.prototype.toISOString,ur=rr.default,lr={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:er.encode,encodeValuesOnly:!1,format:ur,formatter:rr.formatters[ur],indices:!1,serializeDate:function(t){return cr.call(t)},skipNulls:!1,strictNullHandling:!1},pr=function t(e,r,n,o,i,s,a,c,u,l,p,f,h,y,d){var g,m=e;if(d.has(e))throw new RangeError("Cyclic object value");if("function"==typeof a?m=a(r,m):m instanceof Date?m=l(m):"comma"===n&&ir(m)&&(m=er.maybeMap(m,(function(t){return t instanceof Date?l(t):t}))),null===m){if(o)return s&&!h?s(r,lr.encoder,y,"key",p):r;m=""}if("string"==typeof(g=m)||"number"==typeof g||"boolean"==typeof g||"symbol"==typeof g||"bigint"==typeof g||er.isBuffer(m))return s?[f(h?r:s(r,lr.encoder,y,"key",p))+"="+f(s(m,lr.encoder,y,"value",p))]:[f(r)+"="+f(String(m))];var v,b=[];if(void 0===m)return b;if("comma"===n&&ir(m))v=[{value:m.length>0?m.join(",")||null:void 0}];else if(ir(a))v=a;else{var w=Object.keys(m);v=c?w.sort(c):w}for(var _=0;_<v.length;++_){var j=v[_],O="object"==typeof j&&void 0!==j.value?j.value:m[j];if(!i||null!==O){var S=ir(m)?"function"==typeof n?n(r,j):r:r+(u?"."+j:"["+j+"]");d.set(e,!0);var A=tr();ar(b,t(O,S,n,o,i,s,a,c,u,l,p,f,h,y,A))}}return b},fr=Ze,hr=Object.prototype.hasOwnProperty,yr=Array.isArray,dr={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:fr.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},gr=function(t){return t.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(parseInt(e,10))}))},mr=function(t,e){return t&&"string"==typeof t&&e.comma&&t.indexOf(",")>-1?t.split(","):t},vr=function(t,e,r,n){if(t){var o=r.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,i=/(\[[^[\]]*])/g,s=r.depth>0&&/(\[[^[\]]*])/.exec(o),a=s?o.slice(0,s.index):o,c=[];if(a){if(!r.plainObjects&&hr.call(Object.prototype,a)&&!r.allowPrototypes)return;c.push(a)}for(var u=0;r.depth>0&&null!==(s=i.exec(o))&&u<r.depth;){if(u+=1,!r.plainObjects&&hr.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;c.push(s[1])}return s&&c.push("["+o.slice(s.index)+"]"),function(t,e,r,n){for(var o=n?e:mr(e,r),i=t.length-1;i>=0;--i){var s,a=t[i];if("[]"===a&&r.parseArrays)s=[].concat(o);else{s=r.plainObjects?Object.create(null):{};var c="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,u=parseInt(c,10);r.parseArrays||""!==c?!isNaN(u)&&a!==c&&String(u)===c&&u>=0&&r.parseArrays&&u<=r.arrayLimit?(s=[])[u]=o:s[c]=o:s={0:o}}o=s}return o}(c,e,r,n)}},br=function(t,e){var r,n=t,o=function(t){if(!t)return lr;if(null!=t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");var e=t.charset||lr.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=rr.default;if(void 0!==t.format){if(!nr.call(rr.formatters,t.format))throw new TypeError("Unknown format option provided.");r=t.format}var n=rr.formatters[r],o=lr.filter;return("function"==typeof t.filter||ir(t.filter))&&(o=t.filter),{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:lr.addQueryPrefix,allowDots:void 0===t.allowDots?lr.allowDots:!!t.allowDots,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:lr.charsetSentinel,delimiter:void 0===t.delimiter?lr.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:lr.encode,encoder:"function"==typeof t.encoder?t.encoder:lr.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:lr.encodeValuesOnly,filter:o,format:r,formatter:n,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:lr.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:lr.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:lr.strictNullHandling}}(e);"function"==typeof o.filter?n=(0,o.filter)("",n):ir(o.filter)&&(r=o.filter);var i=[];if("object"!=typeof n||null===n)return"";var s=or[e&&e.arrayFormat in or?e.arrayFormat:e&&"indices"in e?e.indices?"indices":"repeat":"indices"];r||(r=Object.keys(n)),o.sort&&r.sort(o.sort);for(var a=tr(),c=0;c<r.length;++c){var u=r[c];o.skipNulls&&null===n[u]||ar(i,pr(n[u],u,s,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,a))}var l=i.join(o.delimiter),p=!0===o.addQueryPrefix?"?":"";return o.charsetSentinel&&(p+="iso-8859-1"===o.charset?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),l.length>0?p+l:""},wr={formats:Ve,parse:function(t,e){var r=function(t){if(!t)return dr;if(null!=t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");return{allowDots:void 0===t.allowDots?dr.allowDots:!!t.allowDots,allowPrototypes:"boolean"==typeof t.allowPrototypes?t.allowPrototypes:dr.allowPrototypes,allowSparse:"boolean"==typeof t.allowSparse?t.allowSparse:dr.allowSparse,arrayLimit:"number"==typeof t.arrayLimit?t.arrayLimit:dr.arrayLimit,charset:void 0===t.charset?dr.charset:t.charset,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:dr.charsetSentinel,comma:"boolean"==typeof t.comma?t.comma:dr.comma,decoder:"function"==typeof t.decoder?t.decoder:dr.decoder,delimiter:"string"==typeof t.delimiter||fr.isRegExp(t.delimiter)?t.delimiter:dr.delimiter,depth:"number"==typeof t.depth||!1===t.depth?+t.depth:dr.depth,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof t.interpretNumericEntities?t.interpretNumericEntities:dr.interpretNumericEntities,parameterLimit:"number"==typeof t.parameterLimit?t.parameterLimit:dr.parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:"boolean"==typeof t.plainObjects?t.plainObjects:dr.plainObjects,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:dr.strictNullHandling}}(e);if(""===t||null==t)return r.plainObjects?Object.create(null):{};for(var n="string"==typeof t?function(t,e){var r,n={},o=(e.ignoreQueryPrefix?t.replace(/^\?/,""):t).split(e.delimiter,e.parameterLimit===1/0?void 0:e.parameterLimit),i=-1,s=e.charset;if(e.charsetSentinel)for(r=0;r<o.length;++r)0===o[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===o[r]?s="utf-8":"utf8=%26%2310003%3B"===o[r]&&(s="iso-8859-1"),i=r,r=o.length);for(r=0;r<o.length;++r)if(r!==i){var a,c,u=o[r],l=u.indexOf("]="),p=-1===l?u.indexOf("="):l+1;-1===p?(a=e.decoder(u,dr.decoder,s,"key"),c=e.strictNullHandling?null:""):(a=e.decoder(u.slice(0,p),dr.decoder,s,"key"),c=fr.maybeMap(mr(u.slice(p+1),e),(function(t){return e.decoder(t,dr.decoder,s,"value")}))),c&&e.interpretNumericEntities&&"iso-8859-1"===s&&(c=gr(c)),u.indexOf("[]=")>-1&&(c=yr(c)?[c]:c),n[a]=hr.call(n,a)?fr.combine(n[a],c):c}return n}(t,r):t,o=r.plainObjects?Object.create(null):{},i=Object.keys(n),s=0;s<i.length;++s){var a=i[s],c=vr(a,n[a],r,"string"==typeof t);o=fr.merge(o,c,r)}return!0===r.allowSparse?o:fr.compact(o)},stringify:br};function _r(t,e,r){return o(this,void 0,void 0,(function*(){const n=t.clone();n.request=e,n.config=r,n.data=yield function(t,e){return o(this,void 0,void 0,(function*(){try{if(e.responseType)switch(e.responseType){case"blob":return yield t.blob();case"arraybuffer":return yield t.arrayBuffer();case"document":case"text":return yield t.text();case"json":return yield t.json();case"stream":return(yield t.blob()).stream()}return"application/json"===t.headers.get("content-type")?t.json():t.text()}catch(Dr){return{}}}))}(t,r);let i=Array.from(t.headers.entries());if(Object.entries(h.all([i.map((([t,e])=>[at(t),e])).reduce(ot,{}),i.map((([t,e])=>[t.split("-").map((t=>nt.ucfirst(t))).join("-"),e])).reduce(ot,{}),i.reduce(ot,{})])).forEach((([t,e])=>{n.headers[t]=e,n.headers.set(t,e)})),!t.ok){try{n.errorText=yield t.text()}catch(Dr){n.errorText=""}n.error=new rt(t,e)}return n}))}class jr{constructor(t,e){return this._clientConfig=t,this._Request=e,this._config={},this._params={},this._headers=new Headers,new Proxy(this,{get:(t,e,r)=>Reflect.has(t,e)?Reflect.get(t,e,r):r=>(t._config[e]=r,t),set:(t,e,r,n)=>"function"==typeof t[e]?t[e](r):Reflect.set(t,e,r,n)})}getConfig(){return"json"===this._config.responseType&&(this._headers.has("accept")||this._headers.set("accept","application/json")),Object.assign(Object.assign({},this._config),{headers:this._headers,url:this._config.url?this.getUri(this._config.url):this._config.url})}hasParams(){return Object.keys(this._params).length>0}stringifyParams(t={}){return wr.stringify(this._params,Object.assign(Object.assign({},t),{arrayFormat:"indices"}))}getUri(t){let e="";return this.hasParams()&&(e=this.stringifyParams({addQueryPrefix:!0})),nt.ensureRight(this._clientConfig.baseURL,"/")+nt.stripLeft(t,"/")+e}merge(t){return Object.entries(t).forEach((([t,e])=>this[t](e))),this}header(t,e){return this._headers.set(t,e),this}param(t,e){return this._params[t]=e,this}headers(t){var e;return e=this._headers,new Headers(t).forEach(((t,r)=>e.set(r,t))),this}params(t){return this._params=h.all([this._params,t]),this}data(t){return this._headers.set("Content-Type","application/json"),this._config.body=JSON.stringify(t),this}basic(t,e){return this.authorization("Basic",btoa(t+":"+e))}bearer(t){return this.authorization("Bearer",t)}authorization(t,e){return this._headers.set("Authorization",t+" "+e),this}make(){const t=this.getConfig();return new this._Request(t.url,t)}}class Or extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Array.prototype)}}class Sr{constructor(t,e={},r=!0){return this._stream=t,this._data=e,this._fresh=r,new Proxy(this,{get:(t,e,r)=>Reflect.has(t,e)?Reflect.get(t,e,r):Reflect.has(t._data,e)?Reflect.get(t._data,e):void 0,set:(t,e,r,n)=>Reflect.has(t,e)?Reflect.set(t,e,r,n):Reflect.set(t._data,e,r)})}get http(){return this._stream.streams.http}get stream(){return this._stream}save(){return o(this,void 0,void 0,(function*(){try{return this._fresh?(yield this.http.postEntry(this._stream.id,this._data),!0):(yield this.http.patchEntry(this._stream.id,this._data.id,this._data),!0)}catch(Dr){return!1}}))}validator(){}}class Ar extends Or{constructor(t,e,r){super(...t),this.meta=e,this.links=r}static fromResponse(t,e){const r=Object.values(t.data.data).map((t=>new Sr(e,t,!1)));return new Ar(r,t.data.meta,t.data.links)}}class Er extends Or{constructor(t,e,r){super(...t),this.meta=e,this.links=r}static fromResponse(t,e){const r=Object.values(t.data.data).map((t=>new Sr(e,t,!1)));return new Er(r,t.data.meta,t.data.links)}}const Pr=[">","<","==","!=",">=","<=","!<","!>","<>"],xr=["BETWEEN","EXISTS","OR","AND","NOT","IN","ALL","ANY","LIKE","IS NULL","UNIQUE"],kr=[].concat(Pr).concat(xr),Rr=t=>kr.includes(t);class $r{constructor(t){this.stream=t,this.parameters=[]}get http(){return this.stream.streams.http}find(t){return o(this,void 0,void 0,(function*(){return this.where("id",t).first()}))}first(){return o(this,void 0,void 0,(function*(){return(yield this.limit(1).get())[0]}))}cache(){return this}orderBy(t,e="desc"){return this.addParameter("orderBy",[t,e]),this}limit(t){return this.addParameter("limit",t),this}where(...t){let e,r,n,o;if(2===t.length?(e=t[0],r="==",n=t[1]):3===t.length?(e=t[0],r=t[1],n=t[2]):4===t.length&&(e=t[0],r=t[1],n=t[2],o=t[3]),!Rr(r))throw new Error(`Criteria where() operator "${r}" not valid `);return this.addParameter("where",[e,r,n,o]),this}orWhere(...t){let e,r,n;if(2===t.length?(e=t[0],r="==",n=t[1]):(e=t[0],r=t[1],n=t[2]),!Rr(r))throw new Error(`Criteria orWhere() operator "${r}" not valid `);return this.addParameter("where",[e,r,n,"or"]),this}get(){return o(this,void 0,void 0,(function*(){const t={parameters:this.compileParameters()},e=yield this.http.getEntries(this.stream.id,t);return Ar.fromResponse(e,this.stream)}))}paginate(t=100,e=1){return o(this,void 0,void 0,(function*(){let r={parameters:this.compileParameters(),paginate:!0,per_page:t,page:e};const n=yield this.http.getEntries(this.stream.id,r);return Er.fromResponse(n,this.stream)}))}create(t){return o(this,void 0,void 0,(function*(){let e=this.newInstance(t);return yield e.save(),e}))}save(t){return o(this,void 0,void 0,(function*(){return t.save()}))}delete(){return this}newInstance(t){return new Sr(this.stream,t,!0)}getParameters(){return this.parameters}setParameters(t){return this.parameters=t,this}addParameter(t,e){return this.parameters.push({name:t,value:e}),this}compileParameters(){return this.parameters.map((t=>{return{[t.name]:(e=t.value,Array.isArray(e)?e:[e])};var e}))}}class Ir{constructor(t){Object.assign(this,t)}}class Tr{constructor(t){this.stream=t}get http(){return this.stream.streams.http}all(){return o(this,void 0,void 0,(function*(){let t=yield this.http.getEntries(this.stream.id),e=t.data.data.map((t=>new Sr(this.stream,t,!1)));return new Ar(e,t.data.meta,t.data.links)}))}find(t){return o(this,void 0,void 0,(function*(){return this.stream.entries().where("id",t).first()}))}findAll(t){return o(this,void 0,void 0,(function*(){return this.stream.entries().where("id","IN",t).get()}))}findBy(t,e){return o(this,void 0,void 0,(function*(){return this.stream.entries().where(t,e).first()}))}findAllWhere(t,e){return o(this,void 0,void 0,(function*(){return this.stream.entries().where(t,e).get()}))}create(t){return o(this,void 0,void 0,(function*(){let e=this.newCriteria().newInstance(t);return e.save(),e}))}save(t){return o(this,void 0,void 0,(function*(){return t.save()}))}delete(t){return o(this,void 0,void 0,(function*(){return yield this.http.deleteEntry(this.stream.id,t.id),!0}))}truncate(){return this}newInstance(t){return this.newCriteria().newInstance(t)}newCriteria(){return new $r(this.stream)}}class Cr{constructor(t,e,r,n){this.streams=t,this.meta=r,this.links=n,e.fields&&(this.fields=new Map(Object.entries(e.fields).map((([t,e])=>[t,new Ir(e)]))),delete e.fields),Object.assign(this,e)}get repository(){return this._repository||(this._repository=new Tr(this)),this._repository}entries(){return this.repository.newCriteria()}}var Mr;exports.Method=void 0,(Mr=exports.Method||(exports.Method={})).connect="CONNECT",Mr.delete="DELETE",Mr.get="GET",Mr.head="HEAD",Mr.options="OPTIONS",Mr.patch="PATCH",Mr.post="POST",Mr.put="PUT",Mr.trace="TRACE",exports.Client=class{constructor(t){this.hooks={createRequest:new tt(["factory"]),request:new tt(["request"]),response:new et(["response","request"])},this.config=h({headers:{"X-Requested-With":"XMLHttpRequest"},request:{method:"GET",credentials:"include",errorHandling:"throw"}},t)}request(t,e,r={}){return o(this,void 0,void 0,(function*(){r=this.getRequestConfig(t,e,r);let n=this.createRequest(r);n=this.hooks.request.call(n);let o=yield fetch(n),i=yield _r(o,n,r);if(i=yield this.hooks.response.promise(i,n),i.error&&"throw"===r.errorHandling)throw i.error;return i}))}createRequest(t={}){let e=this.createRequestFactory(t);return e.headers(this.config.headers),e=this.hooks.createRequest.call(e),e.make()}createRequestFactory(t={}){return function(t,e=Request){return new jr(t,e)}(this.config).merge(t)}getRequestConfig(t,e,r={}){return this.mergeRequestConfig(r,{method:t,url:e})}mergeRequestConfig(...t){return h.all([this.config.request,...t||[]],{clone:!0})}},exports.Collection=Or,exports.Criteria=$r,exports.Entry=Sr,exports.EntryCollection=Ar,exports.Field=Ir,exports.FieldCollection=class extends Or{},exports.HTTPError=rt,exports.Http=class{constructor(t){this.streams=t}get client(){return this.streams.client}get config(){return this.streams.config}getStreams(t={},e={}){return o(this,void 0,void 0,(function*(){return this.client.request("get","/streams",Object.assign({params:t},e))}))}postStream(t,e={}){return o(this,void 0,void 0,(function*(){return this.client.request("post","/streams",Object.assign({data:t},e))}))}getStream(t,e={},r={}){return o(this,void 0,void 0,(function*(){return this.client.request("get",`/streams/${t}`,r)}))}patchStream(t,e={},r={}){return o(this,void 0,void 0,(function*(){return this.client.request("patch",`/streams/${t}`,Object.assign({data:e},r))}))}putStream(t,e={},r={}){return o(this,void 0,void 0,(function*(){return this.client.request("put",`/streams/${t}`,Object.assign({data:e},r))}))}deleteStream(t,e={}){return o(this,void 0,void 0,(function*(){return this.client.request("delete",`/streams/${t}`,e)}))}getEntries(t,e={},r={}){return o(this,void 0,void 0,(function*(){return this.client.request("get",`/streams/${t}/entries`,Object.assign({params:e},r))}))}postEntry(t,e={},r={}){return o(this,void 0,void 0,(function*(){return this.client.request("post",`/streams/${t}/entries`,Object.assign({data:e},r))}))}getEntry(t,e,r={}){return o(this,void 0,void 0,(function*(){return this.client.request("get",`/streams/${t}/entries/${e}`,r)}))}patchEntry(t,e,r={},n={}){return o(this,void 0,void 0,(function*(){return this.client.request("patch",`/streams/${t}/entries/${e}`,Object.assign({data:r},n))}))}putEntry(t,e,r={},n={}){return o(this,void 0,void 0,(function*(){return this.client.request("put",`/streams/${t}/entries/${e}`,Object.assign({data:r},n))}))}deleteEntry(t,e,r={}){return o(this,void 0,void 0,(function*(){return this.client.request("patch",`/streams/${t}/entries/${e}`,r)}))}request(t,e,r={}){return o(this,void 0,void 0,(function*(){return(yield this.client.request(t,e,r)).data}))}},exports.PaginatedEntryCollection=Er,exports.Repository=Tr,exports.RequestFactory=jr,exports.Str=nt,exports.Stream=Cr,exports.Streams=class{constructor(t){this.config=t,this.hooks={all:new et(["data"]),make:new et(["data"]),maked:new Z(["stream"]),create:new et(["data"]),created:new Z(["stream"])},this.client=new t.Client(this.config),this.http=new t.Http(this)}all(){return o(this,void 0,void 0,(function*(){const t=yield this.http.getStreams(),e=[];for(let r of t.data.data){r=yield this.hooks.all.promise(r);const n=new Cr(this,r,t.data.meta,t.data.links);e.push(n)}return e}))}make(t){return o(this,void 0,void 0,(function*(){let e=yield this.http.getStream(t);e.data=yield this.hooks.make.promise(e.data);const{data:r,meta:n,links:o}=e.data,i=new Cr(this,r,n,o);return this.hooks.maked.call(i),i}))}create(t,e){return o(this,void 0,void 0,(function*(){let r=yield this.http.postStream(Object.assign({id:t,name:t},e));r.data=yield this.hooks.create.promise(r.data);const{data:n,meta:o,links:i}=r.data,s=new Cr(this,n,o,i);return this.hooks.created.call(s),s}))}entries(t){return o(this,void 0,void 0,(function*(){const e=yield this.make(t);return new $r(e)}))}repository(t){return o(this,void 0,void 0,(function*(){const e=yield this.make(t);return new Tr(e)}))}collection(){}},exports.comparisonOperators=Pr,exports.logicalOperators=xr,exports.objectify=ot,exports.operators=kr;
